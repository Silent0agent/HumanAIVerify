{% extends "base.html" %}
{% load i18n %}

{% block title %}
  <title>{{ task.title }}</title>
{% endblock title %}

{% block content %}
  <h1>{{ task.title }}</h1>

  <div class="task-info">
    {% translate "Task_information" %}
    <p>
      <strong>{% translate "Created_at" %}:</strong>
      {{ task.created_at|date:"d.m.Y H:i" }}
    </p>

    {% if task.description %}
      <p>
        <strong>{% translate "Description" %}:</strong> {{ task.description }}
      </p>
    {% endif %}

    <p>
      <strong>{% translate "Content" %}:</strong>
    </p>
    <div class="content-box">{{ task.content|linebreaks }}</div>

    <p>
      <strong>{% translate "AI_score" %}:</strong>
      {% if task.ai_score %}
        {{ task.ai_score|floatformat:1 }}%
      {% else %}
        {% translate "Not_evaluated" %}
      {% endif %}
    </p>

    <p>
      <strong>{% translate "Total_checks" %}:</strong> {{ task.checks_count }}
    </p>
  </div>

  <div class="checks-list">
    <h2>{% translate "Checks" %}</h2>

    {% if task.checks.all %}
      <table>
        <thead>
          <tr>
            <th>{% translate "Performer" %}</th>
            <th>{% translate "AI_score" %}</th>
            <th>{% translate "Comment" %}</th>
            <th>{% translate "Published_at" %}</th>
            <th>{% translate "Actions" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for check in task.checks.all %}
            <tr>
              <td>{{ check.performer.username }}</td>
              <td>{{ check.ai_score }}%</td>
              <td>
                {% if check.comment %}
                  {{ check.comment|truncatechars:100 }}
                {% else %}
                  {% translate "No_comment" %}
                {% endif %}
              </td>
              <td>{{ check.updated_at|date:"d.m.Y H:i" }}</td>
              <td>
                <a href="{% url 'tasks:text-check-detail' check.id %}">{% translate "View_details" %}</a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p>{% translate "No_checks_yet" %}.</p>
    {% endif %}
  </div>

  <a href="{% url 'tasks:my-text-tasks' %}">{% translate "Back_to_my_tasks" %}</a>
{% endblock content %}
